"use strict";function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var _createClass=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),EatThemAll=function(){function n(t,i){var r=this;_classCallCheck(this,n);this.canvas=t[0];this.server=i;this.canvas.width=window.innerWidth;this.canvas.height=window.innerHeight;this.ctx=canvas.getContext("2d");this.running=!1;this.width=this.height=5e3;this.offset={x:this.canvas.width/2,y:this.canvas.height/2};this.initialized=!1;this.id="";this.gridSize=30;this.player;t.bind("contextmenu",function(n){if(n.preventDefault(),r.initialized&&r.running){var t={x:(n.offsetX-r.offset.x)/(r.offset.x/5),y:(n.offsetY-r.offset.y)/(r.offset.y/5)};r.server.updateDirection(t)}})}return _createClass(n,[{key:"start",value:function(){this.running=!0}},{key:"stop",value:function(){this.running=!1}},{key:"checkInitialize",value:function(){this.initialized=typeof this.ctx!="undefined"&&(typeof this.id!="undefined"||this.id!="")&&typeof this.server!="undefined"}},{key:"render",value:function(n){var t=this;if(this.running&&this.initialized){if(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.player=n.find(function(n){return n.id===t.id}),this.player==null&&server!=null){server.GetConnectionId();return}this.renderGrid({x:-this.player.location.x%this.gridSize,y:-this.player.location.y%this.gridSize});this.ctx.shadowBlur=10;n.forEach(function(n){return t.renderPlayer(n)});this.ctx.shadowBlur=0;this.renderLabels()}}},{key:"renderLabels",value:function(){this.ctx.globalAlpha=1;this.ctx.fillStyle="black";this.ctx.font="20px Arial";this.ctx.textAlign="center";this.ctx.textBaseline="top";this.ctx.fillText("Score: "+this.player.score,this.canvas.width/2,0)}},{key:"renderPlayer",value:function(n){var t={x:n.location.x-this.player.location.x+this.offset.x,y:n.location.y-this.player.location.y+this.offset.y};t.x<-10||t.y<-10||t.x>this.canvas.width+10||t.y>this.canvas.height+10||(this.ctx.globalAlpha=n.alpha,this.ctx.beginPath(),this.ctx.fillStyle=n.color,this.ctx.arc(t.x,t.y,n.radius,0,2*Math.PI),this.ctx.fill(),this.ctx.globalAlpha=1,this.ctx.textAlign="center",this.ctx.textBaseline="bottom",this.ctx.fillStyle="black",this.ctx.font="12px Arial",this.ctx.fillText(n.name+("["+n.location.x+","+n.location.y+"]"),t.x,t.y-n.radius))}},{key:"renderGrid",value:function(n){for(var i,t=n.x;t<this.canvas.width;t+=this.gridSize)this.ctx.moveTo(t,0),this.ctx.lineTo(t,this.canvas.height);for(i=n.y;i<this.canvas.height;i+=this.gridSize)this.ctx.moveTo(0,i),this.ctx.lineTo(this.canvas.width,i);this.ctx.globalAlpha=.3;this.ctx.strokeWidth=.1;this.ctx.strokeStyle="Black";this.ctx.stroke()}},{key:"id",set:function(n){this._id=n;this.checkInitialize()},get:function(){return this._id}}]),n}();